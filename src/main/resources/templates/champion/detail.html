<!doctype html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <!-- 파비콘 -->
    <link rel="icon" type="image/png" href="/static/images/ff15-favicon.svg">

    <title th:text="${champ.name} + ' - 상세'">챔피언 상세</title>
    <link rel="stylesheet" href="/static/css/champion-detail.css"/>

    <!-- Ribbon Menu -->
    <link rel="stylesheet" href="/static/css/ribbon.css">
</head>
<body>
<div th:replace="fragments/header :: header"></div>
<section class="container">

    <!-- 헤더 -->
    <div class="header-card">
        <img class="avatar" th:src="${iconUrl}" alt="챔피언 아이콘"/>

        <div class="title">
            <h1>
                <span th:text="${champ.name}">징크스</span>
                <small th:text="${champ.title}">난폭한 말괄량이</small>
            </h1>
            <div class="version" th:text="'v' + ${v}">v15.18.1</div>

            <!-- 스킬 아이콘 + 툴팁 -->
            <div class="skill-row">
                <div class="skill" th:if="${passiveIcon != null}">
                    <img th:src="${passiveIcon}" alt="P"/>
                    <div class="tip">
                        <b th:text="'P - ' + ${champ.passive.name}">신난다!</b>
                        <div class="muted" th:text="${champ.passive.description}"></div>
                    </div>
                </div>
                <div class="skill" th:each="s, i : ${spells}">
                    <img th:src="${s.icon}" th:alt="${s.id}"/>
                    <div class="tip">
                        <b th:text="${#strings.substring('QWER', i.index, i.index + 1)} + ' - ' + ${s.name}"></b>
                        <div class="muted" th:utext="${s.tooltip}"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 탭 -->
    <div class="tabs">
        <div class="tab-headers">
            <button data-tab="base" class="active">기본 정보</button>
            <button data-tab="build">빌드</button>
            <button data-tab="skins">스킨</button>
        </div>

        <div class="tab-body">
            <section class="tab-panel active" id="tab-base">
                <h2>역할군</h2>
                <!-- 역할군 아이콘 -->
                <div class="role-icons">
                    <div th:each="role : ${roleIcons}" class="role-item">
                        <img th:src="${role.icon}" th:alt="${role.name}" class="role-icon"/>
                        <span th:text="${role.name}" class="role-name"></span>
                    </div>
                </div>

                <hr/>

                <h2>기본 스탯</h2>
                <div class="stats-grid" th:if="${champ.stats != null}">
                    <div><span>체력</span><b th:text="${champ.stats.hp}"></b></div>
                    <div><span>성장 체력</span><b th:text="${champ.stats.hpperlevel}"></b></div>
                    <div><span>공격력</span><b th:text="${champ.stats.attackdamage}"></b></div>
                    <div><span>성장 공격력</span><b th:text="${champ.stats.attackdamageperlevel}"></b></div>
                    <div><span>마나/자원</span><b th:text="${champ.stats.mp}"></b></div>
                    <div><span>성장 자원</span><b th:text="${champ.stats.mpperlevel}"></b></div>
                    <div><span>공속</span><b th:text="${champ.stats.attackspeed}"></b></div>
                    <div><span>이동속도</span><b th:text="${champ.stats.movespeed}"></b></div>
                    <div><span>방어력</span><b th:text="${champ.stats.armor}"></b></div>
                    <div><span>마법저항력</span><b th:text="${champ.stats.spellblock}"></b></div>
                    <div><span>사거리</span><b th:text="${champ.stats.attackrange}"></b></div>
                    <div><span>체력 재생</span><b th:text="${champ.stats.hpregen}"></b></div>
                </div>

                <hr/>

                <h2>배경</h2>

                <p class="lore" th:text="${champ.lore != null ? champ.lore : champ.blurb}">설명</p>
            </section>

            <!-- 빌드(샘플 자리) -->
            <section class="tab-panel" id="tab-build">
                <div class="build-position" id="build-position">
                    <button class="position-btn" data-pos="Top">
                        <img class="position-img" src="/static/images/position/Top.png" alt="Top"/>
                    </button>
                    <button class="position-btn" data-pos="Jungle">
                        <img class="position-img" src="/static/images/position/Jungle.png" alt="Jungle"/>
                    </button>
                </div>
                <p class="placeholder">빌드/룬/아이템은 추후 DDragon 외부 데이터로 연동 예정입니다.</p>
            </section>

            <!-- 스킨 -->
            <section class="tab-panel" id="tab-skins">
                <div class="skins" th:if="${skins != null}">
                    <figure class="skin" th:each="sk : ${skins}">
                        <img th:src="${sk.splash}" th:alt="${sk.name}"/>
                        <figcaption th:text="${sk.name}">기본 스킨</figcaption>
                    </figure>
                </div>
            </section>

        </div>
    </div>
</section>

<!-- 오버레이 -->
<div class="overlay" id="overlay">
    <span class="close-btn" id="closeOverlay">&times;</span>
    <img src="" alt="Skin Preview" id="overlayImg"/>
</div>

<script>
    // 탭 스위치 (바닐라)
    const btns=[...document.querySelectorAll('.tab-headers button')];
    const panels={
        base: document.getElementById('tab-base'),
        build: document.getElementById('tab-build'),
        skins: document.getElementById('tab-skins'),
    };
    btns.forEach(b=>b.addEventListener('click', ()=>{
        btns.forEach(x=>x.classList.remove('active'));
        b.classList.add('active');
        Object.values(panels).forEach(p=>p.classList.remove('active'));
        panels[b.dataset.tab].classList.add('active');
    }));

    const overlay = document.getElementById('overlay');
    const overlayImg = document.getElementById('overlayImg');
    const closeOverlay = document.getElementById('closeOverlay');
    const skinImgs = document.querySelectorAll('.skin img');

    // 이미지 클릭 → 오버레이 열기
    skinImgs.forEach(img => {
        img.addEventListener('click', () => {
            overlay.classList.add('active');
            overlayImg.src = img.src;
            overlayImg.alt = img.alt;
        });
    });

    // 닫기 버튼 → 오버레이 닫기
    closeOverlay.addEventListener('click', () => {
        overlay.classList.remove('active');
    });

    // 배경 클릭 → 오버레이 닫기
    overlay.addEventListener('click', (e) => {
        if (e.target === overlay) {
            overlay.classList.remove('active');
        }
    });


    // 포지션 버튼 클릭
    const container = document.getElementById("build-position");
    container.addEventListener("click", e => {
        const btn = e.target.closest(".position-btn");
        if (!btn) return; // 버튼이 아닌 곳 클릭 시 무시
        console.log(`${btn.dataset.pos} 버튼 클릭됨`);
    });
</script>


</body>
</html>
